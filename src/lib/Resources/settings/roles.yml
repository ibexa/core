imports:
    - { resource: limitations/language.yml }

parameters:
    ezpublish.api.role.policy_map: {}

services:
    ## Implemented Limitations
    ezpublish.api.role.limitation_type.content_type:
        class: Ibexa\Core\Limitation\ContentTypeLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Class}

    ezpublish.api.role.limitation_type.language:
        class: Ibexa\Core\Limitation\LanguageLimitationType
        arguments:
            $persistenceLanguageHandler: '@ezpublish.spi.persistence.language_handler'
            $persistenceContentHandler: '@ezpublish.spi.persistence.content_handler'
            $versionTargetEvaluators: !tagged ibexa.permissions.limitation_type.language_target_evaluator.version
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Language}

    ezpublish.api.role.limitation_type.location:
        class: Ibexa\Core\Limitation\LocationLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Node}

    ezpublish.api.role.limitation_type.owner:
        class: Ibexa\Core\Limitation\OwnerLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Owner}

    ezpublish.api.role.limitation_type.parent_content_type:
        class: Ibexa\Core\Limitation\ParentContentTypeLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: ParentClass}

    ezpublish.api.role.limitation_type.parent_depth:
        class: Ibexa\Core\Limitation\ParentDepthLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: ParentDepth}

    ezpublish.api.role.limitation_type.parent_owner:
        class: Ibexa\Core\Limitation\ParentOwnerLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: ParentOwner}

    ezpublish.api.role.limitation_type.parent_group:
        class: Ibexa\Core\Limitation\ParentUserGroupLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: ParentGroup}

    ezpublish.api.role.limitation_type.section:
        class: Ibexa\Core\Limitation\SectionLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Section}

    ezpublish.api.role.limitation_type.new_section:
        class: Ibexa\Core\Limitation\NewSectionLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: NewSection}

    ezpublish.api.role.limitation_type.siteaccess:
        class: Ibexa\Core\Limitation\SiteAccessLimitationType
        arguments: ['@ezpublish.siteaccess_service']
        tags:
            - {name: ibexa.permissions.limitation_type, alias: SiteAccess}

    ezpublish.api.role.limitation_type.state:
        class: Ibexa\Core\Limitation\ObjectStateLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: State}

    ezpublish.api.role.limitation_type.new_state:
        class: Ibexa\Core\Limitation\NewObjectStateLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: NewState}

    ezpublish.api.role.limitation_type.subtree:
        class: Ibexa\Core\Limitation\SubtreeLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Subtree}

    ezpublish.api.role.limitation_type.user_group:
        class: Ibexa\Core\Limitation\UserGroupLimitationType
        arguments: ["@ezpublish.api.persistence_handler"]
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Group}

    ezpublish.api.role.limitation_type.status:
        class: Ibexa\Core\Limitation\StatusLimitationType
        tags:
            - {name: ibexa.permissions.limitation_type, alias: Status}

    ## Non implemented Limitations
    # Configured to use "blocking" limitation (as they are not implemented) to avoid LimitationNotFoundException

    # ezjscore limitations, not applicable by API/Platform stack, users are adviced to use Symfony for ajax controllers
    ezpublish.api.role.limitation_type.function_list:
        class: Ibexa\Core\Limitation\BlockingLimitationType
        arguments: ['FunctionList']
        tags: [{name: ibexa.permissions.limitation_type, alias: FunctionList}]

    # Misc limitations used by ezcomments, not applicable to Platform replacement: EzCommentsBundle
    ezpublish.api.role.limitation_type.ezcomments.content_section:
        class: Ibexa\Core\Limitation\BlockingLimitationType
        arguments: ['ContentSection']
        tags: [{name: ibexa.permissions.limitation_type, alias: ContentSection}]

    ezpublish.api.role.limitation_type.ezcomments.comment_creator:
        class: Ibexa\Core\Limitation\BlockingLimitationType
        arguments: ['CommentCreator']
        tags: [{name: ibexa.permissions.limitation_type, alias: CommentCreator}]

    ezpublish.api.role.limitation_type.ezcomments.anti_spam:
        class: Ibexa\Core\Limitation\BlockingLimitationType
        arguments: ['AntiSpam']
        tags: [{name: ibexa.permissions.limitation_type, alias: AntiSpam}]
